All Products
<div class="float_r">

  <%= collection_select "category", nil, @categories, :id, :name, {:include_blank => "All"} %>
  <input type="text" id="search" />
  <%= link_to '+', new_admin_store_product_path, :class => "add_item" %>
</div>
<br/><br/>

<div id="products">
  <%= render :partial => 'product_holder', :locals => { :products => @products }%>
</div>

<div class="pagination">
  <% @pages_count.times do |page| %>
    <a href="#" page="<%= page + 1 %>" class="<%= (@current_page == (page + 1).to_s)?"current":"" %>" onclick="go_to_page(this, <%= page + 1%>);">
      <%= page + 1 %>
    </a>
  <% end %>
</div>

<script>

    function refresh_search_results(page){
        page = page || 1;
        keyword = j("#search").val();
        category = j("#category_").val();
        j.ajax({
            url: "<%= admin_store_products_path(@store) %>",
            type: 'GET',
            data: {q : keyword, category_id : category, page : page, requestasync : "yes"},
            beforeSend: function () {
            },
            complete: function(){
            },
            error: function(err){
                alert("error");
            },
            success: function(data){
                j("#products").html(data);
            }
        });
    }

    function go_to_page(element, page){
       j(".current").removeClass("current");
       j(element).addClass("current");
       refresh_search_results(page);
    }

  j(document).ready(function(){
      j("#search").keyup(function(){
          refresh_search_results();
      });
      j("#category_").change(function(){
          refresh_search_results();
      });
  });


</script>




